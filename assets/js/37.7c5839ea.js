(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{389:function(t,e,a){"use strict";a.r(e);var s=a(14),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"security"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#security"}},[t._v("#")]),t._v(" Security")]),t._v(" "),e("p",[t._v("This chapter introduces you to the security configuration in eXo Platform:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("JAAS Realm configuration")]),t._v(" Instructions on how to configure JAAS Realm.")]),t._v(" "),e("li",[e("code",[t._v("Enabling HTTPS")]),t._v(" To enable security access, you can either run eXo Platform itself in HTTPS, or more commonly, use a reverse proxy like Apache.")]),t._v(" "),e("li",[e("code",[t._v("Password encryption key of RememberMe")]),t._v(' Information about the file location and steps to update the "Remember My Login" password encryption key.')]),t._v(" "),e("li",[e("code",[t._v("Anti Brute Force")]),t._v(" To configure the mechanim that protects against brute force attacks on password authentication.")]),t._v(" "),e("li",[e("code",[t._v("XSS protection")]),t._v(" To activate XSS protection mechanisms.")]),t._v(" "),e("li",[e("code",[t._v("SameSite Configuration")]),t._v(" To configure SameSite property for cookies")]),t._v(" "),e("li",[e("code",[t._v("Securing the MongoDB Database")]),t._v(" How to secure eXo chat database.")]),t._v(" "),e("li",[e("code",[t._v("Rest Api exposure")]),t._v(" List of REST API exposed by eXo Platform.")])]),t._v(" "),e("h2",{attrs:{id:"jaas-realm-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jaas-realm-configuration"}},[t._v("#")]),t._v(" JAAS Realm configuration")]),t._v(" "),e("p",[t._v("eXo Platform relies on JAAS for propagating the user identity and roles to the different applications deployed on the server. The JAAS realm is used by all eXo Platform applications and even propagated to the JCR for "),e("RouterLink",{attrs:{to:"/reference/html/JCR.AccessControl.html"}},[t._v("Access Control")]),t._v(".\nTherefore, if you need to change the JAAS configuration, consider that your change impacts a lot and it may require you to unpackage and modify some "),e("code",[t._v(".war")]),t._v(" files.")],1),t._v(" "),e("p",[t._v("This section explains:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("What is JAAS Realm?")])]),t._v(" "),e("li",[e("code",[t._v("Declaring JAAS Realm in eXo Platform")])]),t._v(" "),e("li",[e("code",[t._v("List of applications using Realm")])])]),t._v(" "),e("h3",{attrs:{id:"what-is-jaas-realm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#what-is-jaas-realm"}},[t._v("#")]),t._v(" What is JAAS Realm?")]),t._v(" "),e("p",[t._v("The JAAS configuration requires a "),e("a",{attrs:{href:"https://docs.oracle.com/javase/1.5.0/docs/guide/security/jaas/tutorials/LoginConfigFile.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("login.config file"),e("OutboundLink")],1),t._v('.\nThis file contains one (or more) entry which is called a "Realm". Each entry declares a Realm name and at least one login module. Each login module consists of a Java class and some parameters which are specified by the class.')]),t._v(" "),e("p",[t._v("Below is the default Realm in the Tomcat bundle.")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[t._v("    gatein-domain "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      org.gatein.sso.integration.SSODelegateLoginModule required\n        enabled="),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#{gatein.sso.login.module.enabled}"')]),t._v("\n        delegateClassName="),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#{gatein.sso.login.module.class}"')]),t._v("\n        portalContainerName=portal\n        realmName=gatein-domain\n        password-stacking=useFirstPass;\n      org.exoplatform.services.security.j2ee.TomcatLoginModule required\n        portalContainerName=portal\n        realmName=gatein-domain;\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(";\n")])])]),e("p",[t._v("In which:")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("gatein-domain")]),t._v(" is the "),e("strong",[t._v("Realm name")]),t._v(" which will be refered by applications. If you change this default name, you need to re-configure all the applications that use the Realm (listed later).")])]),t._v(" "),e("li",[e("p",[t._v("Two required "),e("strong",[t._v("login modules")]),t._v(" are: "),e("em",[t._v("org.gatein.sso.integration.SSODelegateLoginModule")]),t._v(" and "),e("em",[t._v("org.exoplatform.services.security.j2ee.TomcatLoginModule")]),t._v(". The first, if authentication succeeds, will create an "),e("em",[t._v("Identity")]),t._v(" object and save it into a shared state map, then the object can be used by the second.\nThese are some login modules available in eXo Platform. Refer to "),e("code",[t._v("Existing login modules")]),t._v(" to understand how they match the login scenarios.")])])]),t._v(" "),e("h3",{attrs:{id:"declaring-jaas-realm-in-exo-platform"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#declaring-jaas-realm-in-exo-platform"}},[t._v("#")]),t._v(" Declaring JAAS Realm in eXo Platform")]),t._v(" "),e("h4",{attrs:{id:"in-the-tomcat-bundle"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#in-the-tomcat-bundle"}},[t._v("#")]),t._v(" In the Tomcat bundle")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("The default Realm is declared in the "),e("code",[t._v("$PLATFORM_TOMCAT_HOME/conf/jaas.conf")]),t._v(" file. Its content is exactly the above example.")])]),t._v(" "),e("li",[e("p",[t._v('A "security domain" property in '),e("code",[t._v("$PLATFORM_TOMCAT_HOME/gatein/conf/exo.properties")]),t._v(" (about this file, see "),e("code",[t._v("Configuration overview")]),t._v(" needs to be set equal to the Realm name:")])])]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    exo.security.domain")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("gatein-domain")]),t._v("\n")])])]),e("h3",{attrs:{id:"list-of-applications-using-realm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#list-of-applications-using-realm"}},[t._v("#")]),t._v(" List of applications using Realm")]),t._v(" "),e("p",[t._v("If an application (.war) uses the Realm for authentication and\nauthorization, it will refer to the Realm name with either of the\nfollowing lines.")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("In "),e("code",[t._v("WEB-INF/jboss-web.xml")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("security-domain")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("java:/jaas/gatein-domain"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("security-domain")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("In "),e("code",[t._v("WEB-INF/web.xml")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("realm-name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("gatein-domain"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("realm-name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("In "),e("code",[t._v("META-INF/context.xml")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[t._v("appName='gatein-domain'\n")])])])])]),t._v(" "),e("p",[t._v('As mentioned above, if you change "'),e("code",[t._v("gatein-domain")]),t._v('", you need to\nre-configure all the applications that use the Realm to refer to the new\nRealm. Here is the list of webapps and the files you need to\nre-configure:')]),t._v(" "),e("p",[e("strong",[t._v("In the Tomcat bundle:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("portal.war")]),t._v(": "),e("code",[t._v("/WEB-INF/jboss-web.xml")]),t._v(", "),e("code",[t._v("/WEB-INF/web.xml")]),t._v(",\n"),e("code",[t._v("/META-INF/context.xml")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("rest.war")]),t._v(": "),e("code",[t._v("/WEB-INF/jboss-web.xml")]),t._v(", "),e("code",[t._v("/WEB-INF/web.xml")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("ecm-wcm-extension.war")]),t._v(": "),e("code",[t._v("/WEB-INF/jboss-web.xml")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("calendar-extension.war")]),t._v(": "),e("code",[t._v("/WEB-INF/jboss-web.xml")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("forum-extension.war")]),t._v(": "),e("code",[t._v("/WEB-INF/jboss-web.xml")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("wiki-extension.war")]),t._v(": "),e("code",[t._v("/WEB-INF/jboss-web.xml")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("ecm-wcm-core.war")]),t._v(": "),e("code",[t._v("/WEB-INF/jboss-web.xml")]),t._v(".")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v(".war")]),t._v(" files are located under the "),e("code",[t._v("$PLATFORM_TOMCAT_HOME/webapps")]),t._v("\nfolder.")])]),t._v(" "),e("h2",{attrs:{id:"enabling-https"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#enabling-https"}},[t._v("#")]),t._v(" Enabling HTTPS")]),t._v(" "),e("p",[t._v("In order to enable HTTPS, you can either:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Use a reverse proxy")]),t._v(", such as Apache HTTPd or Nginx, to set up an HTTPS virtual host that runs in front of eXo Platform. This is the recommended way.\nOr:")]),t._v(" "),e("li",[e("code",[t._v("Run eXo Platform itself over HTTPS")])])]),t._v(" "),e("p",[t._v("In both cases, you must have a valid SSL certificate. For testing purpose, you can generate a self-signed SSL certificate.\nFor a production environment, a "),e("code",[t._v("verified SSL certificate")]),t._v(" should be used.")]),t._v(" "),e("h3",{attrs:{id:"generating-a-self-signed-certificate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#generating-a-self-signed-certificate"}},[t._v("#")]),t._v(" Generating a self-signed certificate")]),t._v(" "),e("p",[t._v("Generating a self-signed certificate can be done with "),e("a",{attrs:{href:"https://www.openssl.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenSSL"),e("OutboundLink")],1),t._v(". Once again, a self-signed certificate must be used only for testing purpose, never in production. Use the following command to generate the certificate:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("openssl req "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-x509")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-nodes")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-newkey")]),t._v(" rsa:2048 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-keyout")]),t._v(" cert-key.pem "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-out")]),t._v(" cert.pem "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-subj")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("'/O"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("MYORG/OU"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("MYUNIT/C"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("MY/ST"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("MYSTATE/L"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("MYCITY/CN"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("proxy1.com"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("' "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-days")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("730")]),t._v("\n")])])]),e("p",[t._v('You will use cert-key.pem to certificate the Apache/Nginx server proxy1.com, so the part "'),e("em",[t._v("CN=proxy1.com")]),t._v('" is mportant.')]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("When using a self-signed certificate, users will need to point their browser to "),e("em",[e("a",{attrs:{href:"https://proxy1.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://proxy1.com"),e("OutboundLink")],1)]),t._v(" and accept the security exception.")])]),t._v(" "),e("h3",{attrs:{id:"using-a-reverse-proxy-for-https-in-front-of-exo-platform"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-a-reverse-proxy-for-https-in-front-of-exo-platform"}},[t._v("#")]),t._v(" Using a reverse proxy for HTTPS in front of eXo Platform")]),t._v(" "),e("p",[t._v("Apache or Nginx can both be used as a reverse proxy in front of eXo Platform. The role of the reverse proxy server is to catch HTTPS requests coming from the http clients (e.g web browsers) and to relay them to eXo Platform either via AJP or via HTTP protocol. The following diagram depicts the case described in this section:")]),t._v(" "),e("p",[e("img",{attrs:{src:"images/https_reverse_prx_diagram.png",alt:"image0"}})]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("At this stage, we assume you already have an "),e("code",[t._v("SSL certificate")]),t._v(", either issued by an official certification authority or\nself-signed (for testing).")]),t._v(" "),e("p",[t._v("The examples below will let you setup a basic installation with ssl enabled. You should fine tune your installation before opening it on the web. Mozilla provide a "),e("a",{attrs:{href:"https://mozilla.github.io/server-side-tls/ssl-config-generator/",target:"_blank",rel:"noopener noreferrer"}},[t._v("great site"),e("OutboundLink")],1),t._v(" to help you to find a configuration adapted to your needs.")])]),t._v(" "),e("h4",{attrs:{id:"configuring-apache"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-apache"}},[t._v("#")]),t._v(" Configuring Apache")]),t._v(" "),e("p",[t._v("Before you start, note that for clarity, not all details of the Apache server configuration are described here. The configuration may vary depending on Apache version and your OS, so consult "),e("a",{attrs:{href:"http://httpd.apache.org/docs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache documentation"),e("OutboundLink")],1),t._v(" if you need.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("The supported version of Apache is 2.4 which should be used in a supported version of OS. You can learn more about supported environments "),e("a",{attrs:{href:"https://www.exoplatform.com/terms-conditions/supported-environments.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("h5",{attrs:{id:"required-modules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#required-modules"}},[t._v("#")]),t._v(" Required modules")]),t._v(" "),e("p",[t._v("You need mod_ssl, mod_proxy. They are all standard Apache2 modules, so no installation is required. You just need to enable them with the following command:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" a2enmod ssl proxy proxy_http headers\n")])])]),e("h5",{attrs:{id:"configuring-a-virtual-host-for-the-ssl-port"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-a-virtual-host-for-the-ssl-port"}},[t._v("#")]),t._v(" Configuring a virtual host for the SSL port")]),t._v(" "),e("p",[t._v("Add this to site configuration (you can override the default ssl site "),e("code",[t._v("/etc/apache2/sites-enabled/default-ssl.conf")]),t._v(" or create your own site):")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("VirtualHost")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("*:")]),t._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        ServerName proxy1.com\n        Redirect / https://proxy1.com/\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("VirtualHost")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("VirtualHost")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("*:")]),t._v("443")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v('\n        ServerName proxy1.com\n        ProxyPass / http://exo1.com:8080/\n        ProxyPassReverse / http://exo1.com:8080/\n        ProxyRequests Off\n        ProxyPreserveHost On\n        RequestHeader set "X-Forwarded-Proto" expr=%{REQUEST_SCHEME}\n\n        ProxyPass /cometd ws://exo1.com:8080/cometd max=200 acquire=5000 retry=5 disablereuse=on flushpackets=on\n\n        SSLEngine On\n        SSLCertificateFile /path/to/folder/from/certificate/cert.pem\n        SSLCertificateKeyFile /path/to/folder/from/certificate/cert-key.pem\n    '),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("VirtualHost")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("h4",{attrs:{id:"configuring-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-nginx"}},[t._v("#")]),t._v(" Configuring Nginx")]),t._v(" "),e("p",[t._v("Instructions for installing Nginx can be found "),e("a",{attrs:{href:"http://wiki.nginx.org/Install",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),e("OutboundLink")],1),t._v(". On Debian and Ubuntu you can install Nginx with the following command:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("   "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" nginx\n")])])]),e("p",[t._v("Configure the server "),e("em",[t._v("proxy1.com")]),t._v(" at port "),e("em",[t._v("443")]),t._v(" like this (you can put the configuration in a file like "),e("code",[t._v("/etc/nginx/sites-enabled/proxy1.com")]),t._v("):")]),t._v(" "),e("div",{staticClass:"language-nginx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-nginx"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" proxy1.com")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Redirect all HTTP requests to HTTPS with a 301 Moved Permanently response.")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" https://"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" proxy1.com")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate")]),t._v(" /path/to/file/mycert.pem")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate_key")]),t._v(" /path/to/file/mykey.pem")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://exo1.com:8080")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /cometd/cometd")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://exo1.com:8080")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_http_version")]),t._v(" 1.1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" Upgrade "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_upgrade")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" Connection "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"upgrade"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("The configuration here is a simple one and it works. It can be tuned for advanced usages.")]),t._v(" "),e("h4",{attrs:{id:"configuring-the-http-connector"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-the-http-connector"}},[t._v("#")]),t._v(" Configuring the HTTP connector")]),t._v(" "),e("p",[t._v("In eXo Platform distribution, there is a default HTTP (8080) connector.")]),t._v(" "),e("p",[t._v("In any case, you should configure that connector so that eXo Platform is aware of the proxy in front of it.")]),t._v(" "),e("p",[t._v("Set the following property in "),e("code",[t._v("$PLATFORM_TOMCAT_HOME/gatein/conf/exo.properties")]),t._v(" file:")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    exo.base.url")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("https://proxy1.com")]),t._v("\n")])])]),e("p",[t._v("The connector is configured in "),e("code",[t._v("$PLATFORM_TOMCAT_HOME/conf/server.xml")]),t._v(". Add proxy parameters like this:")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Connector")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("address")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("0.0.0.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8080"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("org.apache.coyote.http11.Http11NioProtocol"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("enableLookups")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("redirectPort")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8443"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("connectionTimeout")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("20000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("disableUploadTimeout")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("URIEncoding")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("compression")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("off"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("compressionMinSize")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("2048"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("noCompressionUserAgents")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v(".*MSIE 6.*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("compressableMimeType")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/html,text/xml,text/plain,text/css,text/javascript"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("proxyName")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("proxy1.com"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("proxyPort")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("443"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("scheme")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),e("h3",{attrs:{id:"running-exo-platform-itself-under-https"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#running-exo-platform-itself-under-https"}},[t._v("#")]),t._v(" Running eXo Platform itself under HTTPS")]),t._v(" "),e("p",[t._v("In the previous section you learnt to configure a reverse proxy in front of eXo Platform, and it is the proxy which encrypts the requests and responses. Alternatively you can configure eXo Platform to allow HTTPS access directly, so no proxy between browsers and eXo Platform. See the following diagram :")]),t._v(" "),e("p",[e("img",{attrs:{src:"images/https_direct_access_diagram.png",alt:"image1"}})]),t._v(" "),e("h4",{attrs:{id:"configuring-exo-platform-s-tomcat"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-exo-platform-s-tomcat"}},[t._v("#")]),t._v(" Configuring eXo Platform's Tomcat")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Set the following property in "),e("code",[t._v("$PLATFORM_TOMCAT_HOME/gatein/conf/exo.properties")]),t._v(" file:")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" exo.base.url")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("https://exo1.com:8443")]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Edit the "),e("code",[t._v("$PLATFORM_TOMCAT_HOME/conf/server.xml")]),t._v(" file by commenting the following lines:")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[t._v("   "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Connector")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("address")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("0.0.0.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8080"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("org.apache.coyote.http11.Http11NioProtocol"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n     "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("enableLookups")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("redirectPort")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8443"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n     "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("connectionTimeout")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("20000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("disableUploadTimeout")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n     "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("URIEncoding")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n     "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("compression")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("off"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("compressionMinSize")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("2048"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n     "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("noCompressionUserAgents")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v(".*MSIE 6.*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("compressableMimeType")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/html,text/xml,text/plain,text/css,text/javascript"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Uncomment the following lines and edit with your "),e("code",[t._v("keystoreFile")]),t._v(" and "),e("code",[t._v("keystorePass")]),t._v(" values:")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[t._v(" "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Connector")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8443"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("org.apache.coyote.http11.Http11Protocol"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("SSLEnabled")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n   "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("maxThreads")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("150"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("scheme")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("secure")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n   "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("clientAuth")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("sslProtocol")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("TLS"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n   "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("keystoreFile")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/path/to/file/serverkey.jks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n   "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("keystorePass")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("123456"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])])])]),t._v(" "),e("p",[t._v("After starting eXo Platform, you can connect to "),e("em",[e("a",{attrs:{href:"https://exo1.com:8443/portal",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://exo1.com:8443/portal"),e("OutboundLink")],1)]),t._v('. If you are testing with dummy server names, make sure you created the host "exo1.com" in the file '),e("code",[t._v("/etc/hosts")]),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"rememberme-token-generation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rememberme-token-generation"}},[t._v("#")]),t._v(" RememberMe Token Generation")]),t._v(" "),e("p",[t._v('eXo Platform supports the "Remember My Login" feature. This guideline\nexplains how the feature works, and how to update the password\nencryption key in server side for security purpose.')]),t._v(" "),e("h3",{attrs:{id:"how-the-feature-works"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-the-feature-works"}},[t._v("#")]),t._v(" How the feature works?")]),t._v(" "),e("p",[t._v('If users select "Remember My Login" when they log in, 2 tokens are generated : one named '),e("code",[t._v("selector")]),t._v("\nand one named "),e("code",[t._v("validator")]),t._v(". The validator is hashed with algorithm "),e("code",[t._v("PBKDF2WithHmacSHA1")]),t._v(".\n"),e("code",[t._v("selector")]),t._v(" and hashed "),e("code",[t._v("validator")]),t._v(" are stored in database, associated to the username, and "),e("code",[t._v("selector.validator")]),t._v(" is sent as cookie to the user.")]),t._v(" "),e("p",[t._v("To validate the cookie, the "),e("code",[t._v("selector")]),t._v(" and the "),e("code",[t._v("validator")]),t._v(" and extracted, then the hash of the validator is calculated, and compared with the value in the database. If both match, token is valid. If it is not expired, the associated user is then automatically loggued in.")]),t._v(" "),e("h2",{attrs:{id:"login-brute-force-attacks-protection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#login-brute-force-attacks-protection"}},[t._v("#")]),t._v(" Login Brute Force Attacks Protection")]),t._v(" "),e("p",[t._v("To prevent an attack based on brute force on login/password form, a built-in protection mechanism exists when multiple failed login attempts occur in a short time, the target user account is temporarily locked for a few minutes. When an account is locked, the user can immediately unlock it by resetting its password through a "),e("strong",[t._v("forgot password")]),t._v(" request.\nTwo properties control the brute force attack protection mechanism.\nTo configure it, you can add them in "),e("code",[t._v("exo.properties")]),t._v(".\nThe following property determines the number of unsuccessful login attempts before the account is locked. The default value is attempts :")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("   exo.authentication.antibruteforce.maxAuthenticationAttempts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("5")]),t._v("\n")])])]),e("p",[t._v("The following property determines how long (in minutes) an account is locked when the protection mechanism is triggered. The default value is 10 minutes :")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("   exo.authentication.antibruteforce.blockingTime")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("10")]),t._v("\n")])])]),e("h2",{attrs:{id:"xss-protection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#xss-protection"}},[t._v("#")]),t._v(" XSS Protection")]),t._v(" "),e("p",[t._v("Even if the XSS protection is handled in the PRODUCT development, some protections can be added on the server side to protect against external threats. They are essentially based on HTTP headers added to the responses to ask the modern browsers to avoid such attacks.")]),t._v(" "),e("p",[t._v("Additional configuration options can be found on the "),e("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy",target:"_blank",rel:"noopener noreferrer"}},[t._v("Content-security-Policy header definition"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"add-xss-protection-headers-on-apache"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#add-xss-protection-headers-on-apache"}},[t._v("#")]),t._v(" Add XSS protection headers on Apache")]),t._v(" "),e("p",[t._v("To manipulate the response headers, the Apache module "),e("a",{attrs:{href:"https://httpd.apache.org/docs/2.4/mod/mod_headers.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("mod_headers"),e("OutboundLink")],1),t._v(" must be activated and the following lines added on your configuration :")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("VirtualHost")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("*:")]),t._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            ...\n            # XSS Protection\n            Header always append X-Frame-Options SAMEORIGIN\n            Header always append X-XSS-Protection 1\n            Header always append Content-Security-Policy \"frame-ancestors 'self'\"\n            ...\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("VirtualHost")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("h3",{attrs:{id:"add-xss-protection-headers-on-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#add-xss-protection-headers-on-nginx"}},[t._v("#")]),t._v(" Add XSS protection headers on Nginx")]),t._v(" "),e("p",[t._v("Add the following line in the "),e("code",[t._v("http")]),t._v(" or "),e("code",[t._v("server")]),t._v(" part of your Nginx configuration :")]),t._v(" "),e("div",{staticClass:"language-nginx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-nginx"}},[e("code",[t._v("    ...\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# XSS Protection")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" X-Frame-Options SAMEORIGIN")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" X-XSS-Protection "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    add_header Content-Security-Policy \"frame-ancestors 'self'\"\n    ...\n")])])]),e("h2",{attrs:{id:"samesite-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#samesite-configuration"}},[t._v("#")]),t._v(" SameSite Configuration")]),t._v(" "),e("p",[t._v("SameSite is a property set on HTTP cookies. It can prevent some CSRF attacks. SameSite property can take one of theses values : None, Strict, and Lax")]),t._v(" "),e("ol",[e("li",[t._v("With value "),e("strong",[t._v("None")]),t._v(", when a request is done on eXo Server, there is no verification on the referer. The cookies is used. For example, when a user receives a malicious email, containing a link forged to call a data-altering REST endpoint such as deleting a space, changing a permission, etc.. if the user has a valid session on eXo, clicking the link would alter data on their behalf. It is a CSRF attack.")]),t._v(" "),e("li",[t._v("With value "),e("strong",[t._v("Strict")]),t._v("; when a request arrives on the eXo server, the referer is verified. If the referer has a different domain than the eXo server's domain, the request will not use the cookie. In the situation described above, the request would not be directly executed. The user would be redirected to the login page first. This behaviour is also applied for HTTP GET requests. So, when a user clicks on a link in a notification for example, he has to login again. With this value, all SSO systems (SAML, OAuth, OpenIdConnect ...), generally based on redirections between different hosts, "),e("strong",[t._v("will not work")]),t._v(".")]),t._v(" "),e("li",[t._v("With value "),e("strong",[t._v("Lax")]),t._v("; when a request arrives on the eXo server, the referer is also verified. If the referer has a different domain than the eXo server's domain, only GET requests will use the cookie. So this intermediate option allows to use links read only endpoints in email notifications, and still protect sensitive requests that may alter data.")])]),t._v(" "),e("p",[t._v("By default, eXo uses "),e("strong",[t._v("Lax")]),t._v(" policy in order to have email notification links and SSO configurations work. It can be  changed by configuration if a different value is needed. For that, rename file (if not already done) "),e("code",[t._v("$PLATFORM_TOMCAT_HOME/bin/setenv-customize.sample.sh")]),t._v(" in "),e("code",[t._v("$PLATFORM_TOMCAT_HOME/bin/setenv-customize.sh")]),t._v(" and then uncomment the line")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("    CATALINA_OPTS")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('"$CATALINA_OPTS -Dexo.cookie.samesite=Lax"')]),t._v("\n    ...\n")])])]),e("p",[t._v("Then modify the value to use "),e("em",[t._v("None")]),t._v(" or "),e("em",[t._v("Strict")])]),t._v(" "),e("p",[t._v("For Windows environment, use the file "),e("code",[t._v("$PLATFORM_TOMCAT_HOME/bin/setenv-customize.sample.bat")])]),t._v(" "),e("h2",{attrs:{id:"secured-mongodb"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#secured-mongodb"}},[t._v("#")]),t._v(" Secured MongoDB")]),t._v(" "),e("p",[t._v("For a quick setup, the add-on by default uses a local and none-authorization connection. However, in production it is likely you will secure your MongoDB, so authorization is required. Below are steps to do this.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("Read "),e("a",{attrs:{href:"http://docs.mongodb.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("MongoDB documentation"),e("OutboundLink")],1),t._v(" for MongoDB security. This setup procedure is applied for "),e("a",{attrs:{href:"https://docs.mongodb.com/v3.2/",target:"_blank",rel:"noopener noreferrer"}},[t._v("MongoDB 3.2"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Start MongoDB and connect to the shell to create a database named "),e("em",[t._v("admin")]),t._v(". Add a user with role "),e("em",[t._v("userAdminAnyDatabase")]),t._v(".")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("     $ mongo\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" use admin\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db.createUser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin"')]),t._v(", pwd: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin"')]),t._v(", roles: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("role: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userAdminAnyDatabase"')]),t._v(", db: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Edit MongoDB configuration to turn on authentication, then restart the server.")]),t._v(" "),e("div",{staticClass:"language-conf extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("     # mongodb.conf\n     # Your MongoDB host.\n     bind_ip = 192.168.1.81\n\n     # The default MongoDB port\n     port = 27017\n\n     # Turn on authentication\n     auth=true\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Create a user having "),e("em",[t._v("readWrite")]),t._v(" role in the database "),e("em",[t._v("chat")]),t._v(" (you can name the database as your desire).")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("     $ mongo "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-port")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("27017")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-host")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.81 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-u")]),t._v(" admin "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" admin "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-authenticationDatabase")]),t._v(" admin\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" use chat\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db.createUser"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exo"')]),t._v(", pwd: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exo"')]),t._v(", roles: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("role: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"readWrite"')]),t._v(", db: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"chat"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Verify the authentication/authorization of the new user:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("     $ mongo "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-port")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("27017")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-host")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.81 "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-u")]),t._v(" exo "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" exo "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-authenticationDatabase")]),t._v(" chat\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" use chat\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db.placeholder.insert"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("description: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" db.placeholder.find"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Create a "),e("code",[t._v("configuration file")]),t._v(" containing these below parameters.")]),t._v(" "),e("div",{staticClass:"language-properties extra-class"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("     dbName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("chat")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("     dbServerHost")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("192.168.1.81")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("     dbServerPort")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("27017")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("     dbAuthentication")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("     dbUser")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("exo")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("     dbPassword")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("exo")]),t._v("\n")])])])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("The parameters above correspond with the values used during creating authorization for MongoDB.")])]),t._v(" "),e("h2",{attrs:{id:"rest-api-exposure"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rest-api-exposure"}},[t._v("#")]),t._v(" Rest Api exposure")]),t._v(" "),e("p",[t._v("eXo Platform exposes a list of Rest API methods. They are used internally by the deployed components but can also be used by your users.")]),t._v(" "),e("p",[t._v("Depending on your use cases, it could be (highly) recommended to block the public access to some of them.")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("/rest/loginhistory/loginhistory/AllUsers")]),t._v(" : to avoid information disclosure and for performance issue.")]),t._v(" "),e("li",[e("code",[t._v("/rest/private/loginhistory/loginhistory/AllUsers/*")]),t._v(" : to avoid information disclosure and for performance issue.")]),t._v(" "),e("li",[e("code",[t._v("/rest/jcr/repository/collaboration/Trash")]),t._v(" : to avoid information disclosure.")]),t._v(" "),e("li",[e("code",[t._v("/rest/")]),t._v(" : Avoid rest services discovery.")]),t._v(" "),e("li",[e("code",[t._v("/portal/rest")]),t._v(" : Avoid rest services discovery.")])]),t._v(" "),e("p",[t._v("The following configuration examples will allow you to block the previously listed Rest URLs with Apache or Nginx.")]),t._v(" "),e("h3",{attrs:{id:"block-sensitive-rest-urls-with-apache"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#block-sensitive-rest-urls-with-apache"}},[t._v("#")]),t._v(" Block sensitive Rest urls with Apache")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[t._v('          # Block login history for performance and security reasons\n          RewriteRule             "/rest/loginhistory/loginhistory/AllUsers"            - [L,NC,R=403]\n          RewriteRule             "/rest/private/loginhistory/loginhistory/AllUsers/*"  - [L,NC,R=403]\n\n          # Block access to trash folder\n          RewriteRule             "/rest/jcr/repository/collaboration/Trash"            - [L,NC,R=403]\n\n          # Don\'t expose REST APIs listing \n          RewriteRule             "^/rest/?$"         -                   [NC,F,L]\n          RewriteRule             "^/portal/rest/?$"  -                   [NC,F,L]\n')])])]),e("h3",{attrs:{id:"block-sensitive-rest-urls-with-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#block-sensitive-rest-urls-with-nginx"}},[t._v("#")]),t._v(" Block sensitive Rest urls with Nginx")]),t._v(" "),e("p",[t._v("You can create redirection rules in several ways with nginx, this is one of the possibles :")]),t._v(" "),e("div",{staticClass:"language-nginx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-nginx"}},[e("code",[t._v("          "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Block login history for performance and security reasons")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /rest/loginhistory/loginhistory/AllUsers")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /rest/private/loginhistory/loginhistory/AllUsers")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n          "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Block access to trash folder")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /rest/jcr/repository/collaboration/Trash")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n          "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Don't expose REST APIs listing ")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~ ^/rest/?$")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~ ^/portal/rest/?$")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);